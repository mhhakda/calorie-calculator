<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Calorie Calculator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Toast Container -->
        <div id="toastContainer" aria-live="polite" class="toast-container"></div>
        
        <!-- Header -->
        <header class="header">
            <div class="container">
                <h1>Smart Calorie Calculator</h1>
                <p>Get personalized nutrition recommendations based on your lifestyle</p>
            </div>
        </header>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span id="currentStep">1</span> of <span id="totalSteps">11</span>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Welcome Screen -->
                <div class="form-step active" id="step-0">
                    <div class="card">
                        <div class="card__body">
                            <h2>Welcome to Your Personal Calorie Calculator</h2>
                            <p>This comprehensive tool will help you determine your daily calorie needs and provide personalized nutrition recommendations based on your goals, lifestyle, and health metrics.</p>
                            <p>We'll ask you 11 quick questions to create a customized plan just for you.</p>
                            <button class="btn btn--primary btn--lg" onclick="nextStep()" aria-label="Start the calorie calculator">Get Started</button>
                        </div>
                    </div>
                </div>

                <!-- Step 1: Age -->
                <div class="form-step" id="step-1">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your age?</h2>
                            <div class="input-group">
                                <input type="number" id="age" min="1" max="120" placeholder="Enter your age" class="input input--lg" required>
                                <label for="age" class="input-label">Age (years)</label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Gender -->
                <div class="form-step" id="step-2">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your gender?</h2>
                            <div class="radio-group" role="radiogroup" aria-labelledby="gender-label">
                                <h3 id="gender-label" class="sr-only">Select your gender</h3>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="male" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Male</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="female" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Female</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="other" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Other</span>
                                </label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Height -->
                <div class="form-step" id="step-3">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your height?</h2>
                            <div class="unit-toggle" role="radiogroup" aria-labelledby="height-unit-label">
                                <h3 id="height-unit-label" class="sr-only">Select height unit</h3>
                                <button type="button" class="unit-btn active" data-unit="cm" onclick="toggleHeightUnit(this)" tabindex="0" aria-checked="true" role="radio">cm</button>
                                <button type="button" class="unit-btn" data-unit="ft" onclick="toggleHeightUnit(this)" tabindex="0" aria-checked="false" role="radio">ft + in</button>
                            </div>
                            <div class="input-group" id="height-cm-group">
                                <input type="number" id="height-cm" min="100" max="250" placeholder="Enter height in cm" class="input input--lg">
                                <label for="height-cm" class="input-label">Height (cm)</label>
                            </div>
                            <div class="input-group hidden" id="height-ft-group">
                                <div class="input-row">
                                    <div class="input-item">
                                        <input type="number" id="height-ft" min="3" max="8" placeholder="Feet" class="input">
                                        <label for="height-ft" class="input-label">Feet</label>
                                    </div>
                                    <div class="input-item">
                                        <input type="number" id="height-in" min="0" max="11" placeholder="Inches" class="input">
                                        <label for="height-in" class="input-label">Inches</label>
                                    </div>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Weight -->
                <div class="form-step" id="step-4">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your weight?</h2>
                            <div class="unit-toggle" role="radiogroup" aria-labelledby="weight-unit-label">
                                <h3 id="weight-unit-label" class="sr-only">Select weight unit</h3>
                                <button type="button" class="unit-btn active" data-unit="kg" onclick="toggleWeightUnit(this)" tabindex="0" aria-checked="true" role="radio">kg</button>
                                <button type="button" class="unit-btn" data-unit="lbs" onclick="toggleWeightUnit(this)" tabindex="0" aria-checked="false" role="radio">lbs</button>
                            </div>
                            <div class="input-group" id="weight-kg-group">
                                <input type="number" id="weight-kg" min="20" max="300" placeholder="Enter weight in kg" class="input input--lg">
                                <label for="weight-kg" class="input-label">Weight (kg)</label>
                            </div>
                            <div class="input-group hidden" id="weight-lbs-group">
                                <input type="number" id="weight-lbs" min="44" max="660" placeholder="Enter weight in lbs" class="input input--lg">
                                <label for="weight-lbs" class="input-label">Weight (lbs)</label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Goal -->
                <div class="form-step" id="step-5">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your primary goal?</h2>
                            <div class="radio-group" role="radiogroup" aria-labelledby="goal-label">
                                <h3 id="goal-label" class="sr-only">Select your fitness goal</h3>
                                <label class="radio-option">
                                    <input type="radio" name="goal" value="lose" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Lose Weight</span>
                                    <span class="radio-description">Create a calorie deficit for fat loss</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="goal" value="maintain" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Maintain Weight</span>
                                    <span class="radio-description">Keep your current weight stable</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="goal" value="gain" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Gain Muscle/Bulk</span>
                                    <span class="radio-description">Build muscle mass with a calorie surplus</span>
                                </label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Activity Level -->
                <div class="form-step" id="step-6">
                    <div class="card">
                        <div class="card__body">
                            <h2>How active are you?</h2>
                            <div class="radio-group" role="radiogroup" aria-labelledby="activity-label">
                                <h3 id="activity-label" class="sr-only">Select your activity level</h3>
                                <label class="radio-option">
                                    <input type="radio" name="activity" value="sedentary" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Sedentary</span>
                                    <span class="radio-description">Little or no exercise, desk job</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="activity" value="light" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Lightly Active</span>
                                    <span class="radio-description">Light exercise 1-3 days/week</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="activity" value="moderate" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Moderately Active</span>
                                    <span class="radio-description">Moderate exercise 3-5 days/week</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="activity" value="active" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Very Active</span>
                                    <span class="radio-description">Hard exercise 6-7 days/week</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="activity" value="super" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Super Active</span>
                                    <span class="radio-description">Very hard exercise, physical job</span>
                                </label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 7: Body Fat (Optional) -->
                <div class="form-step" id="step-7">
                    <div class="card">
                        <div class="card__body">
                            <h2>Body Fat Percentage (Optional)</h2>
                            <p class="step-description">If you know your body fat percentage, we can provide more accurate calculations. Otherwise, you can skip this step.</p>
                            <div class="input-group">
                                <input type="number" id="bodyFat" min="5" max="50" placeholder="Enter body fat %" class="input input--lg">
                                <label for="bodyFat" class="input-label">Body Fat (%)</label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--tertiary" onclick="skipBodyFat()" aria-label="Skip body fat percentage">Skip</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 8: Waist -->
                <div class="form-step" id="step-8">
                    <div class="card">
                        <div class="card__body">
                            <h2>Waist Measurement</h2>
                            <p class="step-description">Measure around your waist at the narrowest point, usually just above the hip bones.</p>
                            <div class="unit-toggle" role="radiogroup" aria-labelledby="waist-unit-label">
                                <h3 id="waist-unit-label" class="sr-only">Select waist unit</h3>
                                <button type="button" class="unit-btn active" data-unit="cm" onclick="toggleWaistUnit(this)" tabindex="0" aria-checked="true" role="radio">cm</button>
                                <button type="button" class="unit-btn" data-unit="inch" onclick="toggleWaistUnit(this)" tabindex="0" aria-checked="false" role="radio">inches</button>
                            </div>
                            <div class="input-group" id="waist-cm-group">
                                <input type="number" id="waist-cm" min="50" max="200" placeholder="Enter waist in cm" class="input input--lg">
                                <label for="waist-cm" class="input-label">Waist (cm)</label>
                            </div>
                            <div class="input-group hidden" id="waist-in-group">
                                <input type="number" id="waist-in" min="20" max="80" placeholder="Enter waist in inches" class="input input--lg">
                                <label for="waist-in" class="input-label">Waist (inches)</label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 9: Work Type -->
                <div class="form-step" id="step-9">
                    <div class="card">
                        <div class="card__body">
                            <h2>What type of work do you do?</h2>
                            <div class="radio-group" role="radiogroup" aria-labelledby="work-label">
                                <h3 id="work-label" class="sr-only">Select your work type</h3>
                                <label class="radio-option">
                                    <input type="radio" name="work" value="desk" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Desk Job</span>
                                    <span class="radio-description">Mostly sitting, computer work</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="work" value="field" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Field Work</span>
                                    <span class="radio-description">Physical labor, standing/walking</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="work" value="mixed" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Mixed</span>
                                    <span class="radio-description">Combination of desk and field work</span>
                                </label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 10: Sleep -->
                <div class="form-step" id="step-10">
                    <div class="card">
                        <div class="card__body">
                            <h2>How many hours do you sleep per day?</h2>
                            <div class="input-group">
                                <input type="number" id="sleep" min="4" max="12" placeholder="Enter average sleep hours" class="input input--lg">
                                <label for="sleep" class="input-label">Sleep Hours (per day)</label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" onclick="nextStep()" aria-label="Go to next step">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 11: Stress -->
                <div class="form-step" id="step-11">
                    <div class="card">
                        <div class="card__body">
                            <h2>What's your stress level?</h2>
                            <div class="radio-group" role="radiogroup" aria-labelledby="stress-label">
                                <h3 id="stress-label" class="sr-only">Select your stress level</h3>
                                <label class="radio-option">
                                    <input type="radio" name="stress" value="low" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Low Stress</span>
                                    <span class="radio-description">Generally relaxed and calm</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="stress" value="medium" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Medium Stress</span>
                                    <span class="radio-description">Some stress but manageable</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="stress" value="high" class="radio-input">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">High Stress</span>
                                    <span class="radio-description">Frequently stressed or anxious</span>
                                </label>
                            </div>
                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="prevStep()" aria-label="Go to previous step">Back</button>
                                <button class="btn btn--primary" id="calculateBtn" onclick="calculateResults()" aria-label="Calculate your results">Calculate Results</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results -->
                <div class="form-step" id="results">
                    <div class="card">
                        <div class="card__body">
                            <h2>Your Personalized Results</h2>
                            
                            <!-- Export Buttons -->
                            <div class="export-buttons">
                                <button class="btn btn--secondary btn--sm" id="copyResultsBtn" onclick="copyResultsJSON()" aria-label="Copy results as JSON" disabled>📋 Copy Results JSON</button>
                                <button class="btn btn--secondary btn--sm" id="downloadPdfBtn" onclick="downloadResultsPDF()" aria-label="Download results as PDF" disabled>📄 Download PDF</button>
                            </div>

                            <div class="results-grid">
                                <div class="result-card">
                                    <h3>Daily Calories</h3>
                                    <div class="result-value" id="maintenanceCalories">0</div>
                                    <div class="result-label">To maintain weight</div>
                                </div>
                                
                                <div class="result-card">
                                    <h3>Goal Calories</h3>
                                    <div class="result-value" id="goalCalories">0</div>
                                    <div class="result-label" id="goalLabel">For your goal</div>
                                </div>

                                <div class="result-card">
                                    <h3>BMI</h3>
                                    <div class="result-value" id="bmi">0</div>
                                    <div class="result-label" id="bmiCategory">Category</div>
                                </div>

                                <div class="result-card">
                                    <h3>Waist-to-Height Ratio</h3>
                                    <div class="result-value" id="waistToHeight">0</div>
                                    <div class="result-label" id="waistCategory">Health indicator</div>
                                </div>
                            </div>

                            <div class="macros-section">
                                <h3>Macronutrient Breakdown</h3>
                                <div class="macro-bars">
                                    <div class="macro-item">
                                        <div class="macro-header">
                                            <span class="macro-name">Protein</span>
                                            <span class="macro-amount" id="proteinAmount">0g (0%)</span>
                                        </div>
                                        <div class="macro-bar">
                                            <div class="macro-fill protein" id="proteinBar"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="macro-item">
                                        <div class="macro-header">
                                            <span class="macro-name">Carbohydrates</span>
                                            <span class="macro-amount" id="carbsAmount">0g (0%)</span>
                                        </div>
                                        <div class="macro-bar">
                                            <div class="macro-fill carbs" id="carbsBar"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="macro-item">
                                        <div class="macro-header">
                                            <span class="macro-name">Fats</span>
                                            <span class="macro-amount" id="fatsAmount">0g (0%)</span>
                                        </div>
                                        <div class="macro-bar">
                                            <div class="macro-fill fats" id="fatsBar"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="recommendations">
                                <h3>Recommendations</h3>
                                <div class="recommendation-item" id="weeklyGoal"></div>
                                <div class="recommendation-item" id="lifestyleTip"></div>
                                <div class="recommendation-item" id="bodyFatDisplay"></div>
                            </div>

                            <div class="button-group">
                                <button class="btn btn--secondary" onclick="startOver()" aria-label="Start over with new calculations">Start Over</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Debug Panel (only visible with ?debug=true) -->
        <div id="debugPanel" class="debug-panel hidden">
            <h4>Debug Info</h4>
            <pre id="debugOutput"></pre>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
